# Project Requirements: Meeting Email Bot

## 1. General
- The system must be written primarily in **Python**.
- The bot must operate using an existing email account: **meeting-bot@gmx.com**.
- The bot must automatically handle **incoming meeting invitation emails**.
- The bot must only process invitations **sent from @deif.com** email addresses.

## 2. Meeting Cost Estimation
- The bot must parse meeting invitations (likely `.ics` calendar files or structured emails).
- It must identify meeting details:
  - **Organizer** (sender)
  - **Participants** (invitees in To/CC fields or calendar invite)
  - **Duration**
- The bot must extract each participant’s **initials** from their email address:
  - Example: `mak@deif.com` → initials = `mak`
- The bot must use **two lookup CSV files** to calculate the estimated meeting cost:
  1. **Initials → Role mapping**  
     Example file (`initials_roles.csv`):  
     ```
     mak,developer
     crh,developer
     kk,ceo
     ```
  2. **Role → Hourly cost mapping**  
     Example file (`role_costs.csv`):  
     ```
     developer,2000
     ceo,4000
     ```
- Cost calculation formula:  
  `Total cost = sum(hourly_rate_of_participant × meeting_duration_hours)`
- If a participant’s initials are not found in the `initials_roles.csv` file:
  - They must be added automatically with role `"undefined"`.
  - Meetings involving `"undefined"` roles must still respond with a **warning** indicating missing role definitions.
- The bot must respond with the cost **only to the sender** of the meeting invitation.

## 3. Feedback Collection
- After the meeting ends (based on the calendar invite time), the bot must:
  - Send an **anonymous feedback survey** to all participants.
  - Feedback must include at least:
    - "Was this meeting useful?" (Yes/No)
    - "What could be improved?" (optional free text)
- Participants have **1 day** to submit feedback.
- After 1 day, feedback must be **aggregated** and sent to the original organizer, regardless of whether all participants responded.
- Responses must be **anonymized** (so the organizer cannot see individual identities).

## 4. Email Handling
- Incoming emails must be retrieved via **IMAP**.
- Outgoing emails must be sent via **SMTP**.
- The bot must support handling `.ics` calendar invitations.
- All automated replies must include a clear footer (e.g., _"This message was generated by MeetingBot"_).

## 5. Data Storage
- Meeting and feedback data must be stored to track:
  - Meeting time
  - Participants
  - Feedback responses and submission timestamps
- Storage must be in:
  - A local **SQLite database**
  - Each meeting has its own temporary database
  - Finnished meetings where feedback has been sent to the organizer, must be moved to one big database, so deeper analysis and statistics can be performed later.
- The bot must automatically trigger feedback aggregation **1 day after the meeting ends**.

## 6. Security & Privacy
- Credentials for the bot’s email account must **not** be hardcoded.
  - They must be stored in environment variables or a `.env` file.
- Feedback must remain **anonymous**; participants’ emails must not be linked to their responses in the organizer’s report.
- Logs must not include sensitive participant content.

## 7. Testing
- The project must include **unit tests** (using `pytest`).
- Tests should **mock email sending/receiving** (so no real emails are sent during tests).
- Cost calculation logic, initials/role lookup, and feedback timing/aggregation must be tested.

## 8. Future Enhancements (Optional)
- Web dashboard for tracking meetings, roles, and feedback.
- Configurable role lookup through a web interface.
- Natural Language Processing to extract meeting details from plain emails (instead of `.ics` only).
- Multi-language support in feedback forms.
